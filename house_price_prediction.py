# -*- coding: utf-8 -*-
"""House_price_prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1AOi0p4aj7SjQIfOP7h-I-5w3ZvQmLjPX

#Model for Nashik House Price Prediction

##Loading Dataset
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
house_data = pd.read_csv('/content/drive/MyDrive/Data for ML(rough)/final_nashik_data.csv')
house_data

"""##Data Preparation

###Data separation into X and Y

####For Y
"""

y = house_data['price']
y

"""####For X

"""

x = house_data.drop('price', axis=1)
x

"""##Splitting the data into trainning set and testing set"""

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.33,random_state=80)

"""##Model Building -> Linear Regression

###Trainning the Model
"""

from sklearn.linear_model import LinearRegression
lr_model = LinearRegression()
lr_model.fit(x_train,y_train)

"""###Applying the model to make prediction"""

y_lr_train_pred = lr_model.predict(x_train)
y_lr_test_pred = lr_model.predict(x_test)

y_lr_train_pred

y_lr_test_pred

"""###Evaluate the model performance or accuracy"""

from sklearn.metrics import mean_squared_error, r2_score
lr_train_mse = mean_squared_error(y_train,y_lr_train_pred)
lr_train_r2 = r2_score(y_train,y_lr_train_pred)
lr_test_mse = mean_squared_error(y_test,y_lr_test_pred)
lr_test_r2 = r2_score(y_test,y_lr_test_pred)

lr_result = pd.DataFrame(['Linear Regression',lr_train_mse,lr_train_r2,lr_test_mse,lr_test_r2]).transpose()
lr_result.columns = ['Method','Training MSE','Training R2','Test MSE','Test R2']

lr_result

import numpy as np
print(np.mean(y_test - y_lr_test_pred)**2)

"""##Data Visualization of predicted results"""

import matplotlib.pyplot as plt
plt.scatter(x=y_train,y=y_lr_train_pred,c="#FF0000",alpha=0.3)
plt.ylabel('Predicted')
plt.xlabel('Actual')
plt.plot()